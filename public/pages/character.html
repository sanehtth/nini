<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>T·∫°o prompt Nh√¢n V·∫≠t ‚Äì LearnQuest AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- D√πng l·∫°i style chung -->
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    /* M·ªôt ch√∫t style ri√™ng cho trang character, d√πng chung tone v·ªõi site */

    .char-page-wrap {
      max-width: 960px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.12);
      overflow: hidden;
    }

    .char-header {
      background: #e11d48;
      color: #fff;
      padding: 16px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .char-header h1 {
      font-size: 20px;
      margin: 0;
    }

    .char-header a {
      color: #fee2e2;
      font-size: 13px;
      text-decoration: none;
    }

    .char-body {
      padding: 24px 24px 28px;
    }

    .char-section-title {
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 15px;
    }

    .char-help {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 8px;
    }

    .char-grid-2 {
      display: grid;
      grid-template-columns: 1.1fr 1.3fr;
      gap: 20px;
    }

    .char-field {
      margin-bottom: 12px;
    }

    .char-field label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 4px;
    }

    .char-field small {
      display: block;
      font-size: 11px;
      color: #6b7280;
      margin-top: 2px;
    }

    .char-input,
    .char-textarea {
      width: 100%;
      border-radius: 10px;
      border: 1px solid #d4d4d8;
      padding: 8px 10px;
      font-size: 13px;
      resize: vertical;
      box-sizing: border-box;
    }

    .char-textarea {
      min-height: 60px;
      line-height: 1.4;
    }

    .char-actions-row {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .char-actions-row .main-btn {
      padding-inline: 18px;
    }

    .char-json-note {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }

    .char-footer-note {
      margin-top: 12px;
      font-size: 11px;
      color: #6b7280;
    }

    .char-json-area {
      width: 100%;
      min-height: 150px;
      font-family: "Consolas","Courier New",monospace;
      font-size: 12px;
      border-radius: 10px;
      border: 1px solid #d4d4d8;
      padding: 8px 10px;
      box-sizing: border-box;
      resize: vertical;
    }

    @media (max-width: 768px) {
      .char-grid-2 {
        grid-template-columns: 1fr;
      }
      .char-body {
        padding: 18px 16px 22px;
      }
    }
  
/* --- Tabs UI --- */
.topbar{position:sticky;top:0;background:#111827;color:#fff;padding:12px 16px;z-index:10;border-bottom:1px solid rgba(255,255,255,.12)}
.brand{display:flex;flex-direction:column;gap:2px}
.brand-title{font-weight:700;letter-spacing:.3px}
.brand-sub{font-size:12px;opacity:.8}
.tabs{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
.tab-btn{background:rgba(255,255,255,.08);color:#fff;border:1px solid rgba(255,255,255,.12);padding:8px 12px;border-radius:10px;cursor:pointer}
.tab-btn.active{background:#fff;color:#111827}
.tab-panel{display:none}
.tab-panel.active{display:block}
.container{max-width:1000px;margin:0 auto;padding:18px 14px}
.grid-2{display:grid;grid-template-columns:1fr;gap:14px}
@media(min-width:900px){.grid-2{grid-template-columns:1fr 1fr}}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:14px}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:10px}
.lbl{display:block;font-weight:600;margin-top:10px;margin-bottom:6px}
.hint{color:#4b5563;margin:8px 0 0 0}
.hint.small{font-size:12px}
.muted{color:#6b7280;font-size:12px}
.ghost{background:#f3f4f6;border:1px solid #e5e7eb}
.code{width:100%;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
.hidden{display:none}
.swatches{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.swatch{width:28px;height:28px;border-radius:8px;border:1px solid rgba(0,0,0,.12)}
.field-row{display:flex;gap:10px;align-items:center;margin:8px 0}
.field-row input[type="text"]{flex:1}
.field-row input[type="color"]{width:44px;height:34px;padding:0;border:none;background:transparent}

</style>
  <script src="../js/character.js" defer></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand-title">ADN Tools</div>
      <div class="brand-sub">X√¢y nh√¢n v·∫≠t / style b·∫±ng form (kh√¥ng c·∫ßn nh·∫≠p JSON)</div>
    </div>
    <nav class="tabs" role="tablist" aria-label="ADN tabs">
      <button class="tab-btn active" data-tab="tab-character" role="tab" aria-selected="true">Character</button>
      <button class="tab-btn" data-tab="tab-style" role="tab" aria-selected="false">Style</button>
      <button class="tab-btn" data-tab="tab-background" role="tab" aria-selected="false">Background</button>
      <button class="tab-btn" data-tab="tab-outfit" role="tab" aria-selected="false">Outfit</button>
    </nav>
  </header>

  <section id="tab-character" class="tab-panel active" role="tabpanel">

  <div class="char-page-wrap">
    <header class="char-header">
      <div>
        <a href="admin.html">&larr; V·ªÅ Admin</a>
        <h1>T·∫°o prompt Nh√¢n V·∫≠t</h1>
      </div>
      <div style="font-size:13px;">Tool t·∫°o prompt + JSON cho character sheet</div>
    </header>

    <main class="char-body">
      

  <section class="card" id="adnSection">
    <h2>K·∫øt n·ªëi ADN / character.json</h2>
    <div class="row">
      <label for="adnUrl">URL ho·∫∑c ƒë∆∞·ªùng d·∫´n character.json</label>
      <input id="adnUrl" type="text" value="adn/xomnganchuyen/character.json" />
      <button id="loadAdnBtn" type="button">T·∫£i danh s√°ch</button>
    </div>
    <div class="row">
      <label for="adnCharacterSelect">Ch·ªçn nh√¢n v·∫≠t t·ª´ ADN</label>
      <select id="adnCharacterSelect">
        <option value="">(ch∆∞a t·∫£i)</option>
      </select>
      <button id="loadSelectedBtn" type="button">N·∫°p v√†o form</button>
    </div>
    <div class="row">
      <label for="importFile">Import character.json t·ª´ m√°y</label>
      <input id="importFile" type="file" accept="application/json" />
      <button id="importFileBtn" type="button">Import</button>
    </div>
    <div class="row">
      <label for="modeMerge3d">Tr∆∞·ªùng 3D (t√πy ch·ªçn)</label>
      <textarea id="char3dJson" placeholder='V√≠ d·ª•: {"modelUrl":"...","rig":"...","voice":"..."}'></textarea>
    </div>
    <p class="hint">
      G·ª£i √Ω: b·∫°n c√≥ th·ªÉ d√πng section n√†y ƒë·ªÉ qu·∫£n l√Ω c√πng l√∫c nh√¢n v·∫≠t 2D (Xom1000chuyen) v√† metadata 3D. 
      Export s·∫Ω ƒë√≥ng g√≥i trong c√πng m·ªôt object.
    </p>
  </section>

<section>
        <div class="char-section-title">Th√¥ng tin nh√¢n v·∫≠t</div>
        <p class="char-help">
          ƒêi·ªÅn c√°c field ng·∫Øn g·ªçn, sau ƒë√≥ b·∫•m <strong>"T·∫°o prompt nh√¢n v·∫≠t"</strong>.
          Prompt AI s·∫Ω xu·∫•t hi·ªán b√™n ph·∫£i, v√† b·∫°n c√≥ th·ªÉ th√™m v√†o danh s√°ch JSON ƒë·ªÉ qu·∫£n l√Ω nhi·ªÅu nh√¢n v·∫≠t.
        </p>

        <div class="char-grid-2">
          <!-- C·ªôt tr√°i: th√¥ng tin nh√¢n v·∫≠t (2D / Xom1000chuyen) -->
          <div class="char-col">
            <div class="char-form-group">
              <label for="charId">ID nh√¢n v·∫≠t *</label>
              <input id="charId" class="char-input" type="text" placeholder="Kha_001, Luna_01..." />
              <div class="char-note">N·∫øu ƒë·ªÉ tr·ªëng, tool s·∫Ω t·ª± t·∫°o ID theo timestamp.</div>
            </div>

            <div class="char-form-group">
              <label for="charName">T√™n nh√¢n v·∫≠t</label>
              <input id="charName" class="char-input" type="text" placeholder="A Kha, Luna, ..." />
            </div>

            <div class="char-form-group">
              <label for="charSummary">M√¥ t·∫£ nh√¢n v·∫≠t (th√¥)</label>
              <textarea id="charSummary" class="char-textarea" rows="3" placeholder="V√≠ d·ª•: C·∫≠u b√© t√≥c ƒëen, d√°ng ng∆∞·ªùi nh·ªè, phong c√°ch fantasy r·ª´ng t·ªëi..."></textarea>
            </div>

            <div class="char-form-group">
              <label for="charAgeRole">Tu·ªïi / vai tr√≤ (1 d√≤ng)</label>
              <input id="charAgeRole" class="char-input" type="text" placeholder="A 12‚Äì14-year-old ancient steampunk crafter boy" />
            </div>

            <div class="char-form-group">
              <label for="charAppearance">Hair / appearance</label>
              <textarea id="charAppearance" class="char-textarea" rows="3" placeholder="Long green hair, low ponytail, messy; bronze gear earring (left only)..."></textarea>
            </div>

            <div class="char-form-group">
              <label for="charOutfit">Outfit / clothing</label>
              <textarea id="charOutfit" class="char-textarea" rows="3" placeholder="Layered tunic, leather belt, worn boots, small satchel..."></textarea>
            </div>
          </div>

          <!-- C·ªôt ph·∫£i: asset + style + 3D (tu·ª≥ ch·ªçn) -->
          <div class="char-col">
            <div class="char-form-group">
              <label for="charImagePath">H√¨nh minh ho·∫° (path)</label>
              <input id="charImagePath" class="char-input" type="text" placeholder="public/assets/character/<ID>_<Name>.webp" />
              <div class="char-note">N·∫øu ƒë·ªÉ tr·ªëng, h·ªá th·ªëng s·∫Ω t·ª± t·∫°o theo ID + Name.</div>
            </div>

            <div class="char-form-group">
              <label for="charTools">Tools &amp; props</label>
              <textarea id="charTools" class="char-textarea" rows="3" placeholder="Small glowing energy core gear, mini bombs, scrolls, brass+wood hybrid tools..."></textarea>
            </div>

            <div class="char-form-group">
              <label for="charColorPalette">Color palette</label>
              <input id="charColorPalette" class="char-input" type="text" placeholder="Forest green, brown leather, antique brass, teal glow" />
            </div>

            <div class="char-form-group">
              <label for="charArtStyle">Artstyle &amp; layout</label>
              <input id="charArtStyle" class="char-input" type="text" placeholder="Anime, ancient-steampunk fantasy hybrid, detailed reference sheet" />
            </div>

            <div class="char-form-group">
              <label for="modelUrl">Tr∆∞·ªùng 3D (tu·ª≥ ch·ªçn)</label>
              <textarea id="modelUrl" class="char-textarea" rows="3" placeholder='V√≠ d·ª•:
{"modelUrl":"...","rig":"...","engine":"threejs"}'></textarea>
              <div class="char-note">G·ª£i √Ω: n·∫øu b·∫°n d√πng chung tool n√†y ƒë·ªÉ qu·∫£n l√Ω nh√¢n v·∫≠t 2D (Xom1000chuyen) v√† metadata 3D. Export s·∫Ω ƒë√≥ng g√≥i trong c√πng m·ªôt object.</div>
            </div>
          </div>
        </div>

      <div class="char-actions-row">
              <button id="buildPromptBtn" class="main-btn" type="button">
                üß™ T·∫°o prompt nh√¢n v·∫≠t
              </button>
              <button id="addToJsonBtn" class="sub-btn" type="button">
                ‚ûï Th√™m v√†o danh s√°ch JSON
              </button>
            </div>

            <p class="char-footer-note">
              * B·∫°n c√≥ th·ªÉ t·∫°o nhi·ªÅu nh√¢n v·∫≠t. M·ªói l·∫ßn b·∫•m ‚ÄúTh√™m v√†o danh s√°ch JSON‚Äù
              s·∫Ω push v√†o m·∫£ng <code>characters</code>. Sau ƒë√≥ c√≥ th·ªÉ t·∫£i xu·ªëng file
              <strong>characters.json</strong>.
            </p>

            <div class="char-actions-row" style="margin-top:6px;">
              <button id="downloadJsonBtn" class="sub-btn" type="button">
                ‚¨á T·∫£i file characters.json
              </button>
              <button id="clearJsonBtn" class="sub-btn" type="button">
                üóë Xo√° danh s√°ch JSON
              </button>
            </div>
          </div>

          <!-- C·ªôt ph·∫£i: prompt + JSON -->
          <div class="form-group">
          <label for="charImagePath">H√¨nh minh ho·∫° (path)</label>
          <input
            type="text"
            id="charImagePath"
            placeholder="public/assets/character/<ID>_<Name>.webp"
           />
          <small>N·∫øu ƒë·ªÉ tr·ªëng, h·ªá th·ªëng s·∫Ω t·ª± t·∫°o theo ID + Name.</small>
          </div>

          <div>
            <div class="char-field">
              <label for="charPromptFinal">Prompt ho√†n ch·ªânh</label>
              <textarea id="charPromptFinal" class="char-textarea" style="min-height:180px;"
                placeholder="Prompt s·∫Ω hi·ªán ·ªü ƒë√¢y sau khi b·∫•m 'T·∫°o prompt nh√¢n v·∫≠t'..."></textarea>
              <div class="char-actions-row" style="margin-top:6px;">
                <button id="copyPromptBtn" class="sub-btn" type="button">üìã Copy prompt</button>
              </div>
            </div>

            <div class="char-field">
              <label for="charJsonOutput">JSON (danh s√°ch t·∫•t c·∫£ nh√¢n v·∫≠t)</label>
              <textarea id="charJsonOutput" class="char-json-area">[]</textarea>
              <p class="char-json-note">
                C·∫•u tr√∫c m·ªói object:
                <code>{ id, name, summary, ageRole, appearance, outfit, tools, colorPalette, artStyle, prompt }</code>.
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  </section>

  <section id="tab-style" class="tab-panel" role="tabpanel">
    <div class="container">
      <h2>Style</h2>
      <p class="hint">Ch·ªçn template ƒë·ªÉ ƒëi·ªÅn nhanh. Ho·∫∑c upload ·∫£nh ƒë·ªÉ l·∫•y palette/√°nh s√°ng r·ªìi t·ª± ch·ªânh (·∫£nh kh√¥ng ƒë∆∞·ª£c l∆∞u).</p>

      <div class="grid-2">
        <div class="card">
          <h3>1) Load template</h3>
          <label class="lbl">Template source</label>
          <input id="styleTemplateUrl" type="text" value="/adn/template/style_templates.json" />
          <div class="row">
            <button id="btnLoadStyleTemplates">Load templates</button>
            <span id="styleTemplateStatus" class="muted"></span>
          </div>

          <label class="lbl">Ch·ªçn style m·∫´u</label>
          <select id="styleTemplateSelect"></select>
          <div class="row">
            <button id="btnApplyStyleTemplate">√Åp d·ª•ng preset</button>
            <button id="btnResetStyleForm" class="ghost">Reset</button>
          </div>
        </div>

        <div class="card">
          <h3>2) Upload ·∫£nh (ch·ªâ ƒë·ªÉ l·∫•y m√†u)</h3>
          <input id="styleRefImage" type="file" accept="image/*" />
          <div class="row">
            <button id="btnAnalyzeImage">Ph√¢n t√≠ch ·∫£nh</button>
            <button id="btnApplyImagePalette" class="ghost">√Åp palette v√†o form</button>
          </div>
          <canvas id="styleCanvas" class="hidden"></canvas>
          <div id="imageSwatches" class="swatches"></div>
          <div class="hint small">Tip: d√πng ·∫£nh b·∫•t k·ª≥ (Vi·ªát/ngo·∫°i). Tool ch·ªâ tr√≠ch m√†u v√† g·ª£i √Ω lighting.</div>
        </div>
      </div>

      <div class="card">
        <h3>3) Style form (theo schema hi·ªán t·∫°i)</h3>

        <div class="grid-2">
          <div>
            <h4>Brand palette</h4>
            <div id="brandPaletteFields"></div>
            <div class="row">
              <button id="btnAddBrandColor" class="ghost">+ Th√™m m√†u</button>
            </div>
          </div>

          <div>
            <h4>Pastel palette</h4>
            <div id="pastelPaletteFields"></div>
            <div class="row">
              <button id="btnAddPastelColor" class="ghost">+ Th√™m m√†u</button>
            </div>
          </div>
        </div>

        <div class="grid-2">
          <div>
            <h4>Emotion tone map</h4>
            <div id="toneMapFields"></div>
            <div class="row">
              <button id="btnAddToneColor" class="ghost">+ Th√™m tone</button>
            </div>
          </div>

          <div>
            <h4>Camera & Lighting</h4>
            <label class="lbl">Camera default</label>
            <select id="cameraDefault"></select>
            <label class="lbl">Lighting default</label>
            <select id="lightingDefault"></select>
            <div class="hint small">Preset list l·∫•y theo template ƒëang √°p d·ª•ng.</div>
          </div>
        </div>

        <div class="row">
          <button id="btnExportStyleJson">Export style.json</button>
          <button id="btnCopyStyleJson" class="ghost">Copy JSON</button>
          <span id="styleExportStatus" class="muted"></span>
        </div>

        <textarea id="styleJsonPreview" class="code" rows="12" readonly></textarea>
      </div>
    </div>
  </section>

  <section id="tab-background" class="tab-panel" role="tabpanel">
    <div class="container">
      <h2>Background</h2>
      <p class="hint">Tab n√†y ƒë·ªÉ b·∫°n/CTV m√¥ t·∫£ background theo khung (trong nh√†/ngo√†i tr·ªùi + s√°ng/t·ªëi + ƒë·ªãa ƒëi·ªÉm c·ª• th·ªÉ). B·∫°n c√≥ th·ªÉ ho√†n thi·ªán sau.</p>
      <div class="card">
        <div class="muted">Ch∆∞a k√≠ch ho·∫°t UI background trong b·∫£n n√†y.</div>
      </div>
    </div>
  </section>

  <section id="tab-outfit" class="tab-panel" role="tabpanel">
    <div class="container">
      <h2>Outfit</h2>
      <p class="hint">Tab n√†y ƒë·ªÉ t·∫°o outfit resource d√πng chung (uniform/personal/event). B·∫°n c√≥ th·ªÉ ho√†n thi·ªán sau.</p>
      <div class="card">
        <div class="muted">Ch∆∞a k√≠ch ho·∫°t UI outfit trong b·∫£n n√†y.</div>
      </div>
    </div>
  </section>
</body>
</html>


