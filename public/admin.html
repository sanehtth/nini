<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>LearnQuest AI â€“ Admin</title>

  <!-- CSS chung -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="dark.css">
  <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <header>
      <h1>Admin Panel</h1>
      <div class="user-info">
        <!-- Vá» trang chÃ­nh (game) -->
        <button class="profile-btn" onclick="window.location.href='index.html'">
          â¬… Vá» trang chÃ­nh
        </button>

        <!-- NÃºt quáº£n lÃ½ ngÆ°á»i dÃ¹ng: sau nÃ y báº¡n táº¡o user-admin.html -->
        <button class="profile-btn" onclick="window.location.href='user-admin.html'">
          ğŸ‘¥ Quáº£n lÃ½ ngÆ°á»i dÃ¹ng
        </button>

        <!-- Äá»•i theme (dÃ¹ng chung vá»›i theme.js) -->
        <button class="profile-btn" onclick="toggleTheme()">
          Dark / Light
        </button>

        <!-- Email admin Ä‘ang Ä‘Äƒng nháº­p -->
        <span id="adminEmail">admin</span>

        <!-- ÄÄƒng xuáº¥t -->
        <button class="logout-btn" id="logoutBtnAdmin">ÄÄƒng xuáº¥t</button>
      </div>
      <p>Xin chÃ o, <span id="adminEmailText"></span> (admin)</p>
    </header>

    <!-- NAV TOOL -->
    <nav class="admin-nav" style="margin-top: 10px; margin-bottom: 10px;">
      <button class="tab-btn admin-tab active" data-target="panel-api">ğŸ”‘ Nháº­p API</button>
      <button class="tab-btn admin-tab" data-target="panel-char">ğŸ§‘â€ğŸ¨ Prompt nhÃ¢n váº­t</button>
      <button class="tab-btn admin-tab" data-target="panel-outfit">ğŸ‘• Prompt Ä‘á»•i outfit</button>
      <button class="tab-btn admin-tab" data-target="panel-story">ğŸ¬ Prompt storyboard</button>
    </nav>

    <!-- PANELS -->
    <main class="admin-main" style="margin-top: 10px;">

      <!-- ================= PANEL 1: API ================= -->
      <section id="panel-api" class="admin-panel">
        <h2>ğŸ”‘ Cáº¥u hÃ¬nh API</h2>
        <p>
          <b>LÆ°u Ã½ chung:</b> API nÃªn dÃ¹ng cho má»¥c Ä‘Ã­ch cÃ¡ nhÃ¢n. Vá»›i web public, tá»‘t nháº¥t dÃ¹ng
          server (Vercel env / Cloud Functions) Ä‘á»ƒ áº©n key, khÃ´ng Ä‘á»ƒ lá»™ trÃªn client.
        </p>

        <!-- PHáº¦N A: LOCAL PROFILES (lÆ°u trÃªn mÃ¡y, dÃ¹ng cho nhiá»u tool khÃ¡c) -->
        <h3 style="margin-top: 16px;">A. API <u>local</u> theo Profile (lÆ°u trong trÃ¬nh duyá»‡t)</h3>
        <p style="font-size: 13px;">
          Má»—i profile cÃ³ 3 loáº¡i API (OpenAI / Google AI / Grok). Dá»¯ liá»‡u chá»‰ náº±m trong
          <code>localStorage</code> cá»§a trÃ¬nh duyá»‡t hiá»‡n táº¡i.
        </p>

        <!-- ID / tÃªn profile -->
        <div class="form-row">
          <label>ID / TÃªn Profile:</label>
          <input id="apiProfileId" class="input" placeholder="vd: sane, anhA..." />
        </div>

        <div class="form-row">
          <label>Chá»n nhÃ  cung cáº¥p:</label>
          <select id="apiProvider" class="input">
            <option value="openai">OpenAI</option>
            <option value="gemini">Google AI</option>
            <option value="grok">Grok (xAI)</option>
          </select>
        </div>

        <div class="form-row">
          <label>API Key (sáº½ lÆ°u trong localStorage trÃªn trÃ¬nh duyá»‡t nÃ y):</label>
          <input id="apiKeyInput" class="input" type="password"
                 placeholder="sk-... / AIza... / xai-..." />
        </div>

        <div class="form-row">
          <button class="main-btn" id="saveApiBtn">ğŸ’¾ LÆ°u local</button>
          <button class="main-btn" id="clearApiBtn">ğŸ§¹ XoÃ¡ local</button>
          <span id="apiStatus" class="small-text"></span>
        </div>

        <hr style="margin: 24px 0;">

        <!-- PHáº¦N B: API THEO USER TRÃŠN FIREBASE -->
        <h3>B. API theo User (lÆ°u trÃªn Firebase /users/&lt;uid&gt;/api)</h3>
        <p style="font-size: 13px;">
          Má»—i tÃ i khoáº£n Ä‘Äƒng nháº­p Firebase sáº½ cÃ³ bá»™ API riÃªng á»Ÿ Realtime Database.
          Chá»‰ user Ä‘Ã³ (vÃ  báº¡n â€“ chá»§ project trÃªn Firebase Console) má»›i xem Ä‘Æ°á»£c.
        </p>

        <!-- 3 input cho tá»«ng provider -->
        <div class="form-row">
          <label>OpenAI API Key:</label>
          <input id="userOpenaiApi" class="input" type="password" placeholder="sk-..." />
        </div>

        <div class="form-row">
          <label>Google AI (Gemini) API Key:</label>
          <input id="userGeminiApi" class="input" type="password" placeholder="AIza..." />
        </div>

        <div class="form-row">
          <label>Grok (xAI) API Key:</label>
          <input id="userGrokApi" class="input" type="password" placeholder="xai-..." />
        </div>

        <div class="form-row">
          <button class="main-btn" id="saveUserApiBtn">ğŸ’¾ LÆ°u API user lÃªn Firebase</button>
          <button class="profile-btn" id="loadUserApiBtn">â¬‡ Táº£i API user tá»« Firebase</button>
          <span id="userApiStatus" class="small-text"></span>
        </div>
      </section>

      <!-- ================= PANEL 2: PROMPT NHÃ‚N Váº¬T ================= -->
      <section id="panel-char" class="admin-panel hidden">
        <h2>ğŸ§‘â€ğŸ¨ Táº¡o prompt NhÃ¢n Váº­t</h2>

        <div class="form-row">
          <label>MÃ´ táº£ nhÃ¢n váº­t (thÃ´):</label>
          <textarea id="charRaw" class="input textarea" rows="4"
            placeholder="VÃ­ dá»¥: Cáº­u bÃ© tÃ³c Ä‘en, dÃ¡ng ngÆ°á»i nhá», phong cÃ¡ch fantasy rá»«ng trÃ´i ná»•i..."></textarea>
        </div>

        <div class="form-row">
          <label>Tuá»•i / dÃ¡ng ngÆ°á»i / tÃ­nh cÃ¡ch (tuá»³ chá»n):</label>
          <input id="charDetail" class="input" placeholder="10â€“12 tuá»•i, slim, gan dáº¡, tÃ² mÃ²..." />
        </div>

        <div class="form-row">
          <label>Artstyle & Ã¡nh sÃ¡ng:</label>
          <input id="charStyle" class="input"
            placeholder="painterly fantasy illustration, soft lighting, full body, 4K" />
        </div>

        <div class="form-row">
          <button class="main-btn" id="buildCharPromptBtn">âœ¨ Táº¡o prompt nhÃ¢n váº­t</button>
          <button class="profile-btn" id="copyCharPromptBtn">ğŸ“‹ Copy</button>
        </div>

        <div class="form-row">
          <label>Character prompt (káº¿t quáº£):</label>
          <textarea id="charFinal" class="input textarea" rows="6"></textarea>
        </div>
      </section>

      <!-- ================= PANEL 3: PROMPT OUTFIT ================= -->
      <section id="panel-outfit" class="admin-panel hidden">
        <h2>ğŸ‘• Táº¡o prompt Ä‘á»•i Outfit</h2>

        <div class="form-row">
          <label>MÃ´ táº£ outfit (thÃ´):</label>
          <textarea id="outfitRaw" class="input textarea" rows="4"
            placeholder="VÃ­ dá»¥: Poncho Ä‘á» hoáº¡ tiáº¿t turquoise, mÅ© rá»™ng vÃ nh, tháº¯t lÆ°ng da, boots cao..."></textarea>
        </div>

        <div class="form-row">
          <label>Kiá»ƒu / vibe:</label>
          <input id="outfitVibe" class="input"
            placeholder="desert adventurer, tribal patterns, warm earthy colors..." />
        </div>

        <div class="form-row">
          <button class="main-btn" id="buildOutfitPromptBtn">âœ¨ Táº¡o prompt outfit</button>
          <button class="profile-btn" id="copyOutfitPromptBtn">ğŸ“‹ Copy</button>
        </div>

        <div class="form-row">
          <label>Outfit prompt (káº¿t quáº£):</label>
          <textarea id="outfitFinal" class="input textarea" rows="6"></textarea>
        </div>

        <hr style="margin: 16px 0;">

        <h3>ğŸ”€ GhÃ©p prompt Ä‘á»•i outfit (Character + Outfit)</h3>
        <p>DÃ¹ng character prompt &amp; outfit prompt á»Ÿ trÃªn Ä‘á»ƒ táº¡o final prompt cho AI váº½.</p>

        <div class="form-row">
          <button class="main-btn" id="buildSwapPromptBtn">ğŸ§¬ Táº¡o final prompt</button>
          <button class="profile-btn" id="copySwapJsonBtn">ğŸ“‹ Copy JSON</button>
        </div>

        <div class="form-row">
          <label>JSON káº¿t quáº£:</label>
          <textarea id="swapJson" class="input textarea" rows="8" readonly></textarea>
        </div>
      </section>

      <!-- ================= PANEL 4: STORYBOARD ================= -->
      <section id="panel-story" class="admin-panel hidden">
        <h2>ğŸ¬ Táº¡o prompt Storyboard (Sora / Flow...)</h2>

        <div class="form-row">
          <label>Bá»‘i cáº£nh / tháº¿ giá»›i:</label>
          <input id="storyWorld" class="input"
            placeholder="Fantasy forest with floating islands, soft magical light..." />
        </div>

        <div class="form-row">
          <label>NhÃ¢n váº­t chÃ­nh:</label>
          <input id="storyChar" class="input"
            placeholder="Young adventurer boy in red poncho and wide-brim hat..." />
        </div>

        <div class="form-row">
          <label>Tone / cáº£m xÃºc:</label>
          <input id="storyTone" class="input"
            placeholder="whimsical, adventurous, cinematic, gentle camera movement..." />
        </div>

        <div class="form-row">
          <label>Sá»‘ cáº£nh (shots):</label>
          <input id="storyShots" class="input" type="number" min="3" max="12" value="6" />
        </div>

        <div class="form-row">
          <button class="main-btn" id="buildStoryboardBtn">ğŸ Táº¡o storyboard prompt</button>
          <button class="profile-btn" id="copyStoryboardBtn">ğŸ“‹ Copy</button>
        </div>

        <div class="form-row">
          <label>Storyboard prompt (dáº¡ng text/liá»‡t kÃª shots):</label>
          <textarea id="storyFinal" class="input textarea" rows="10"></textarea>
        </div>
      </section>
    </main>
  </div>

  <!-- SCRIPT cuá»‘i trang -->
  <script src="js/firebase.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/admin.js"></script>
</body>
</html>
