<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>XNC ‚Äì Video From Story</title>
  <link rel="stylesheet" href="/css/dark.css" />
  <style>
    body { background:#111; color:#eee; font-family: monospace; }
    header button { margin-right:8px; }
    .tab { display:none; }
    .tab.active { display:block; }
    .box { margin-bottom:12px; }
    label { display:block; margin:6px 0 2px; }
    textarea { width:100%; height:200px; }
    input, select, textarea, button {
      background:#222; color:#eee; border:1px solid #444;
      padding:6px;
    }
  </style>
</head>
<body>

<!-- ================= TAB HEADER ================= -->
<header>
  <button id="tabBtnStory" class="active">TAB 1 ‚Äì Story</button>
  <button onclick="showTab('frame'); loadTabScript('frame')">
  TAB 2 ‚Äì Frame
</button>

  <button onclick="showTab('export'); loadTabScript('export')">
  TAB 3 ‚Äì Export
</button>
</header>

<!-- ================= TAB 1 ================= -->
<div id="tabStory" class="tab active">

  <h2>üìñ TAB 1 ‚Äì Story / Parser</h2>

  <!-- Manifest -->
  <div class="box">
    <label>Ch·ªçn truy·ªán t·ª´ manifest</label>
    <select id="manifestSelect"></select>
    <br/><br/>
    <button id="reloadManifestBtn">Reload manifest</button>
    <button id="loadStoryBtn">Load story</button>
  </div>

  <!-- Story Info -->
  <div class="box">
    <label>Story ID</label>
    <input id="storyId" placeholder="XNC001abc"/>

    <label>Story Title</label>
    <input id="storyTitle"/>

    <label>Story Text</label>
    <textarea id="storyText"></textarea>
  </div>

  <!-- Actions -->
  <div class="box">
    <button id="parseStoryBtn">‚úÇÔ∏è T√°ch Story</button>
    <button id="exportStoryStructBtn">‚¨á Xu·∫•t JSON A (Story Struct)</button>
  </div>

</div>

<!-- ================= TAB 2 (CH∆ØA D√ôNG) ================= -->
<div id="tabFrame" class="tab">
  <h2>üéû TAB 2 ‚Äì Frame (ch∆∞a l√†m)</h2>
</div>

<!-- ================= TAB 3 (CH∆ØA D√ôNG) ================= -->
<div id="tabExport" class="tab">
  <h2>üì¶ TAB 3 ‚Äì Export (ch∆∞a l√†m)</h2>
</div>

<!-- ================= JS ================= -->
<script>
/**
 * GLOBAL APP STATE
 * D√πng chung cho TAB 1 ‚Äì TAB 2 ‚Äì TAB 3
 */
window.appState = {
  // ===== TAB 1 =====
  manifest: null,
  stories: [],
  currentStory: null,
  storyStruct: null,   // JSON A

  // ===== TAB 2 =====
  frames: [],          // JSON B
  currentFrameIndex: 0,

  // ===== TAB 3 =====
  exportConfig: {
    provider: null,    // flow | meta | sora
  }
};
</script>
 
<script src="/public/video/tab1.js"></script>
<script src="/public/video/tab2.js"></script>
<script src="/public/video/tab3.js"></script>

<script>
  // TAB SWITCH (ƒë∆°n gi·∫£n)
  const tabs = {
    tabBtnStory: 'tabStory',
    tabBtnFrame: 'tabFrame',
    tabBtnExport: 'tabExport'
  };

  Object.keys(tabs).forEach(btnId => {
    document.getElementById(btnId).onclick = () => {
      Object.values(tabs).forEach(t => document.getElementById(t).classList.remove('active'));
      Object.keys(tabs).forEach(b => document.getElementById(b).classList.remove('active'));
      document.getElementById(tabs[btnId]).classList.add('active');
      document.getElementById(btnId).classList.add('active');
    };
  });
</script>
<script>
function loadTabScript(tab) {
  if (tab === 'frame' && !window.__tab2Loaded) {
    const s = document.createElement('script');
    s.src = 'tab2.js';
    document.body.appendChild(s);
    window.__tab2Loaded = true;
  }

  if (tab === 'export' && !window.__tab3Loaded) {
    const s = document.createElement('script');
    s.src = 'tab3.js';
    document.body.appendChild(s);
    window.__tab3Loaded = true;
  }
}
</script>

</body>
</html>


